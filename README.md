# üõ†Ô∏è juzt-cli-wp

**juzt-cli-wp** is a powerful command-line interface (CLI) tool designed to simplify WordPress development by streamlining the process of setting up, managing, and synchronizing local development environments using Docker or Podman, and handling database and file sync via SSH.

## ‚ú® Features

* **Quick Setup:** Initialize your project with a `juzt.config.js` file using an interactive prompt.
* **Containerized Environment:** Start and stop a local WordPress development server using Docker or Podman.
* **Local Database:** Option to spin up a local MySQL container for the project.
* **Database Synchronization (`db:pull`):** Pull the remote database down to your local container via SSH and `mysqldump`.
* **File Synchronization (`uploads:pull`):** Sync specific remote WordPress directories (like plugins or uploads) to your local machine using `rsync` or `scp`.

## üì¶ Installation

Since this CLI is not published on the public npm registry, you can install it globally directly from its GitHub repository using `pnpm` (as specified in your `package.json`) or `npm`.

**Prerequisites:** You need Node.js, npm/pnpm, and Git installed.

### Using pnpm (Recommended)

```bash
pnpm install -g github:juztstack/JuztCLIWP
````

### Using npm

```bash
npm install -g github:juztstack/JuztCLIWP
```

Replace `<your-github-username>/juzt-cli-wp` with the actual path to your repository.

## üöÄ Usage

The main command for the CLI is `juzt-cli-wp`.

### 1. Initialize the Project

Start by running the `init` command in your project root to create the configuration file:

```bash
juzt-cli-wp init
```

This will guide you through an interactive setup to create the `juzt.config.js` file, defining your local and remote (SSH/DB) settings.

### 2. Start the Environment

Use the `up` command to build the necessary Docker/Podman image (if not already built) and start your local WordPress and Database containers:

```bash
juzt-cli-wp up
```

### 3. Synchronize Database (Pull)

Pull the remote database from your specified SSH host and import it into your local containerized database.

```bash
juzt-cli-wp db:pull
```

> **Note:** This command requires `useLocalDatabase` to be set to `true` and a complete SSH configuration in your `juzt.config.js`.

### 4. Synchronize Files (Pull)

Pull a specific directory from the remote WordPress installation to your local machine. This is typically used for `wp-content/uploads` or large plugin directories.

```bash
# Sync the 'wp-content/uploads/' directory using the default 'rsync' method
juzt-cli-wp uploads:pull --path wp-content/uploads/

# Alternatively, specify 'scp' as the method
juzt-cli-wp uploads:pull --path wp-content/plugins/my-plugin --method scp
```

### 5. Stop and Clean Up

Use the `down` command to stop and remove the running WordPress and Database containers, and delete the generated `wp-config.php` file:

```bash
juzt-cli-wp down
```

## ‚öôÔ∏è Configuration (`juzt.config.js`)

The configuration file is generated by the `init` command and is crucial for all operations. Key sections include:

| Section | Description | Relevant Files |
| :--- | :--- | :--- |
| `name` | Project name (used for container naming). | `down.js`, `docker.js`, `podman.js` |
| `containerManager` | `docker` or `podman`. | `down.js` |
| `localDatabase` | Settings for the local DB container (image, port, password). | `db-pull.js` |
| `database` | Remote DB credentials (host, name, user, password). | `db-pull.js` |
| `server` | Local port binding for the WordPress container. | `docker.js`, `podman.js` |
| `ssh` | Remote connection details (host, port, user, key path). | `db-pull.js`, `getSyncCommand.js`, `getRsyncCommand.js` |

### Gu√≠a universal para usar el dominio sin puerto

#### üåê **Acceso sin puerto (opcional)**

Por defecto, tu sitio local se abre as√≠:

```
http://tusitio.localhost:9080
```

#### ‚úÖ Windows (opcional)

Windows permite redirigir el puerto 80 ‚Üí 9080 usando `netsh`.

**Comando opcional:**

```powershell
netsh interface portproxy add v4tov4 listenport=80 listenaddress=127.0.0.1 connectport=9080 connectaddress=127.0.0.1
```

Eliminar:

```powershell
netsh interface portproxy delete v4tov4 listenport=80 listenaddress=127.0.0.1
```

#### ‚úÖ macOS (opcional)

macOS usa `pfctl` para redirecciones.

**Regla opcional:**

```
rdr pass on lo0 inet proto tcp from any to any port 80 -> 127.0.0.1 port 9080
```

Activar:

```
sudo pfctl -f /etc/pf.conf
sudo pfctl -e
```

Eliminar:

```
sudo pfctl -d
```

---

#### ‚úÖ Linux (opcional)

Linux usa `iptables`.

**Regla opcional:**

```
sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 9080
```

Eliminar:

```
sudo iptables -t nat -D PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 9080
```

## ü§ù Contributing

This is a developer tool and contributions are welcome\! Feel free to open issues or submit pull requests on GitHub.
